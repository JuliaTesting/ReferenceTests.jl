<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ReferenceTests.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ReferenceTests.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"><li><a class="toctext" href="#Contents-1">Contents</a></li><li><a class="toctext" href="#Index-1">Index</a></li><li><a class="toctext" href="#Public-Interface-1">Public Interface</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul><a class="edit-page" href="https://github.com/Evizero/ReferenceTests.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ReferenceTests.jl-Documentation-1" href="#ReferenceTests.jl-Documentation-1">ReferenceTests.jl Documentation</a></h1><p>ReferenceTests.jl is a Julia package that adds a couple of additional macros to your testing toolbox. In particular, it focuses on functionality for testing values against reference files, which in turn the package can help create and update if need be. ReferenceTests.jl is build on top of <a href="https://github.com/JuliaIO/FileIO.jl"><code>FileIO.jl</code></a> and designed to be used alongside <code>Base.Test</code>.</p><h2><a class="nav-anchor" id="Contents-1" href="#Contents-1">Contents</a></h2><ul><li><a href="#ReferenceTests.jl-Documentation-1">ReferenceTests.jl Documentation</a></li><ul><li><a href="#Contents-1">Contents</a></li><li><a href="#Index-1">Index</a></li><li><a href="#Public-Interface-1">Public Interface</a></li></ul></ul><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="#ReferenceTests.@io2str"><code>ReferenceTests.@io2str</code></a></li><li><a href="#ReferenceTests.@test_reference"><code>ReferenceTests.@test_reference</code></a></li><li><a href="#ReferenceTests.@withcolor"><code>ReferenceTests.@withcolor</code></a></li></ul><h2><a class="nav-anchor" id="Public-Interface-1" href="#Public-Interface-1">Public Interface</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReferenceTests.@withcolor" href="#ReferenceTests.@withcolor"><code>ReferenceTests.@withcolor</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@withcolor ex</code></pre><p>Make sure that <code>ex</code> is evaluated while <code>Base.have_color</code> is set to <code>true</code>. The original value of <code>Base.have_color</code> will be restored afterwards.</p><p>This macro is particularily useful for CI, where it is not unusual that  <code>julia</code> is executed without the <code>--color=yes</code> argument by default.</p><pre><code class="language-julia">@withcolor print_with_color(:green, &quot;foo&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Evizero/ReferenceTests.jl/blob/d4287ae24d4dbe02f3dd8366c4f92a1bc4be246b/src/utils.jl#L62-L76">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReferenceTests.@io2str" href="#ReferenceTests.@io2str"><code>ReferenceTests.@io2str</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@io2str ex</code></pre><p>Search and replace the placeholder <code>::IO</code> with a newly allocated <code>Base.IOBuffer</code> which is afterwards converted to a string and returned.</p><p>This macro allows a user to conveniently test text-based printing functionality that require an <code>IO</code> argument. A particularly common example of such would be a custom <code>Base.show</code> method.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using ReferenceTests

julia&gt; @io2str print(::IO, &quot;Hello World&quot;)
&quot;Hello World&quot;

julia&gt; @io2str show(IOContext(::IO, :limit=&gt;true, :displaysize=&gt;(10,10)), &quot;text/plain&quot;, ones(10))
&quot;10-element Array{Float64,1}:\n 1.0\n 1.0\n 1.0\n ⋮  \n 1.0\n 1.0&quot;</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Evizero/ReferenceTests.jl/blob/d4287ae24d4dbe02f3dd8366c4f92a1bc4be246b/src/utils.jl#L1-L23">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReferenceTests.@test_reference" href="#ReferenceTests.@test_reference"><code>ReferenceTests.@test_reference</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@test_reference filename ex [kw...]</code></pre><p>Tests that the expression <code>ex</code> evaluates to the same result as stored in the given reference file, which is denoted by the string <code>filename</code>. Executing the code in an interactive julia session will trigger an interactive dialog if results don&#39;t match. This dialog allows the user to create and/or update the reference files.</p><p>The given string <code>filename</code> is assumed to be the relative path to the file that contains the macro invocation. This likely means that the path <code>filename</code> is relative to the <code>test/</code> folder of your package.</p><p>The file-extension of <code>filename</code>, as well as the type of the result of evaluating <code>ex</code>, determine how the actual value is compared to the reference value. The default implementation will do a simple equality check with the result of <code>FileIO.load</code>. This means that it is the user&#39;s responsibility to have the required IO package installed.</p><p>Colorant arrays (i.e.) receive special treatment. If the extension of <code>filename</code> is <code>txt</code> then the package <code>ImageInTerminal</code> will be used to create a string based cure approximation of the image. This will have low storage requirements and also allows to view the reference file in a simple terminal using <code>cat</code>.</p><p>Another special file extension is <code>sha256</code> which will cause the hash of the result of <code>ex</code> to be stored and compared as plain text. This is useful for a convenient low-storage way of making sure that the return value doesn&#39;t change for selected test cases.</p><p><strong>Examples</strong></p><pre><code class="language-julia"># store as string using ImageInTerminal with encoding size (5,10)
@test_reference &quot;camera.txt&quot; testimage(&quot;cameraman&quot;) size=(5,10)

# using folders in the relative path is allowed
@test_reference &quot;references/camera.png&quot; testimage(&quot;cameraman&quot;)

# Images can also be stored as hash. Note however that this
# can only check for equality (no tolerance possible)
@test_reference &quot;references/camera.sha256&quot; testimage(&quot;cameraman&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Evizero/ReferenceTests.jl/blob/d4287ae24d4dbe02f3dd8366c4f92a1bc4be246b/src/test_reference.jl#L1-L49">source</a></section><footer><hr/></footer></article></body></html>
